<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Add/Edit Nurse</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
body { font-family:'Poppins',sans-serif; background:linear-gradient(135deg,#eef2ff,#f9fbff); min-height:100vh;}
.card { border-radius:20px; padding:30px; max-width:520px; margin:auto; margin-top:100px; box-shadow:0 15px 40px rgba(0,0,0,0.1); animation:slideUp 0.7s ease-out;}
@keyframes slideUp { from {transform:translateY(30px); opacity:0;} to {transform:translateY(0); opacity:1;} }
.form-control, .form-select { border-radius:12px; padding:10px 14px; }
.form-control:focus, .form-select:focus { box-shadow:0 0 0 0.15rem rgba(13,110,253,.25); }
.btn-primary, .btn-secondary { border-radius:12px; padding:10px 24px; }
.header-icon { font-size:36px; color:#0d6efd; }
.time-box { background:#f1f4ff; border-left:4px solid #0d6efd; border-radius:12px; padding:12px; margin-top:15px; display:none; }
label { font-weight:500; }
</style>
</head>
<body>
<div class="card">
<div class="text-center mb-4">
<i class="bi bi-person-badge-fill header-icon"></i>
<h4 class="fw-bold mt-2" th:text="${nurse.id==null?'Add Nurse':'Edit Nurse'}"></h4>
<p class="text-muted mb-0">Hospital Staff Management System</p>
</div>
<form id="nurseForm" action="/nurses/save" method="post">
<input type="hidden" name="id" th:value="${nurse.id}">
<div class="mb-3">
<label class="form-label">Full Name</label>
<input name="name" class="form-control" th:value="${nurse.name}" placeholder="Enter full name" required>
</div>
<div class="mb-3">
<label class="form-label">Qualification</label>
<input name="qualification" class="form-control" th:value="${nurse.qualification}" placeholder="e.g. BSc Nursing" required>
</div>
<div class="row">
<div class="col-md-6 mb-3">
<label class="form-label">Gender</label>
<select name="gender" class="form-select" required>
<option value="">Select</option>
<option th:selected="${nurse.gender=='Male'}" value="Male">Male</option>
<option th:selected="${nurse.gender=='Female'}" value="Female">Female</option>
</select>
</div>
<div class="col-md-6 mb-3">
<label class="form-label">Shift</label>
<select name="shift" class="form-select" required>
<option value="">Select</option>
<option th:selected="${nurse.shift=='DAY'}" value="DAY">DAY</option>
<option th:selected="${nurse.shift=='NIGHT'}" value="NIGHT">NIGHT</option>
</select>
</div>
</div>
<div class="mb-3">
<label class="form-label">Working Status</label>
<select name="status" class="form-select" id="statusSelect" required>
<option th:selected="${nurse.status=='WORKING'}" value="WORKING">WORKING</option>
<option th:selected="${nurse.status=='NOT_WORKING'}" value="NOT_WORKING">NOT WORKING</option>
</select>
</div>
<div class="time-box" id="timeBox">
<p class="mb-1"><strong>Entry Time:</strong> <span id="entryTime" th:text="${nurse.entryTime}">-</span></p>
<p class="mb-0"><strong>Exit Time:</strong> <span id="exitTime" th:text="${nurse.exitTime}">-</span></p>
</div>
<div class="d-flex justify-content-between mt-4">
<button type="submit" class="btn btn-primary"><i class="bi bi-save me-1"></i> Save</button>
<a th:href="@{/nurses}" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Back</a>
</div>
</form>
</div>
<script>
const statusSelect = document.getElementById('statusSelect');
const timeBox = document.getElementById('timeBox');
const entryTimeSpan = document.getElementById('entryTime');
const exitTimeSpan = document.getElementById('exitTime');
if(entryTimeSpan.innerText.trim() || exitTimeSpan.innerText.trim()){
    timeBox.style.display='block';
}
document.getElementById('nurseForm').addEventListener('submit', function(e){
    const status = statusSelect.value;
    if(!status){
        e.preventDefault();
        Swal.fire({ icon:'error', title:'Missing Info', text:'Please select working status' });
        return;
    }
    let msg = status==='WORKING' ? 'Nurse duty started. Entry time recorded.' : 'Nurse duty ended. Exit time recorded.';
    Swal.fire({ icon:'success', title:'Saved Successfully', text:msg, timer:1600, showConfirmButton:false });
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
